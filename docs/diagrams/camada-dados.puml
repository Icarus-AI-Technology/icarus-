@startuml Camada_Dados
!theme cerulean-outline
skinparam linetype ortho
skinparam shadowing false
skinparam packageStyle rectangle

title Camada de Dados - ICARUS v5.0 (OraclusX)

package "Storage Layer" as storage_layer {
  database [PostgreSQL\nSupabase] as DB
  storage [Supabase\nBuckets] as StorageBuckets
  queue [Supabase\nRealtime] as Realtime
  database [Vector Store\n(pgvector/faiss)] as VectorDB
}

package "Application Layer" as app_layer {
  component [Backend API] as BackendAPI
  component [Edge Functions\n(Deno)] as Functions
}

package "Presentation Layer" as presentation_layer {
  component [Frontend React\nOraclusX UI] as Frontend
}

Frontend --> BackendAPI : REST/GraphQL\n(HTTPS)
BackendAPI --> DB : SQL Queries\n(Connection Pool)
BackendAPI --> StorageBuckets : File Upload/Download\n(Presigned URLs)
BackendAPI --> Realtime : Broadcast/Presence\n(WebSocket)
BackendAPI --> VectorDB : Similarity Search\n(Embeddings)
Functions --> VectorDB : AI Operations\n(Semantic Search)
Functions --> DB : Database Access\n(Row Level Security)

note right of storage_layer
  **Storage Layer**
  • PostgreSQL 15 (ACID)
  • Row Level Security (RLS)
  • Triggers & Stored Procedures
  • pgvector para embeddings
  • Supabase Realtime (WebSocket)
  • Object Storage (2TB)
end note

note right of app_layer
  **Application Layer**
  • REST + GraphQL APIs
  • Edge Functions (Deno)
  • Auth & RBAC
  • Business Rules Engine
  • Rate Limiting
  • Circuit Breaker
end note

note right of presentation_layer
  **Presentation Layer**
  • React 18 + TypeScript
  • OraclusX Design System
  • State Management (Context)
  • Realtime Updates
  • Code Splitting
  • PWA Ready
end note

@enduml

